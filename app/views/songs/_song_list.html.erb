<% suppress_header = nil unless local_assigns.has_key? :suppress_header %>
<% use_paging = false unless local_assigns.has_key? :use_paging %>
<% show_search = false  unless local_assigns.has_key? :show_search %>
<% page_length = 10 unless local_assigns.has_key? :page_length %>
<% table_id = "" unless local_assigns.has_key? :table_id %>
<% show_lyrics_snippet = nil unless local_assigns.has_key? :show_lyrics_snippet %>
<% frame_name = "table_frame" unless local_assigns.has_key? :frame_name %>

<%# only show header when the table appears in non-index pages %>
<% if local_assigns.has_key? :frame_name  %>
  <h3 class="section-header">Songs</h3>
<% end %>

<table class="table table-striped table-hover main-search-list"
       data-id="<%= table_id %>"
       data-table-name="Songs"
       data-controller="row-navigation infinite-scroll"
       data-infinite-scroll-url-value="/songs/infinite_scroll"
       data-infinite-scroll-current-page-value="<%= defined?(@pagy) && @pagy ? @pagy.page : 1 %>"
       data-infinite-scroll-has-next-page-value="<%= defined?(@pagy) && @pagy ? @pagy.next.present? : false %>"
       data-infinite-scroll-current-sort-value="<%= params[:sort] %>"
       data-infinite-scroll-current-direction-value="<%= params[:direction] %>"
       data-infinite-scroll-search-type-value="<%= params[:search_type] %>"
       data-infinite-scroll-search-value-value="<%= params[:search_value] %>"
       data-infinite-scroll-query-type-value="<%= params[:query_id].present? ? 'quick_query' : 'search' %>"
       data-infinite-scroll-query-id-value="<%= params[:query_id] %>"
       data-infinite-scroll-query-attribute-value="<%= params[:query_attribute] %>"
       style="table-layout: fixed;">
  <thead>
  <tr>
  <th style="width: 40%;"><%= sortable_column_header('name', 'Name', params[:sort], params[:direction], frame_name) %></th>
  <th style="width: 20%;"><%= sortable_column_header('original_band', 'Original Band', params[:sort], params[:direction], frame_name) %></th>
  <th style="width: 15%;"><%= sortable_column_header('author', 'Author', params[:sort], params[:direction], frame_name) %></th>
  <th style="width: 15%;"><%= sortable_column_header('performances', 'Performances', params[:sort], params[:direction], frame_name) %></th>
  <% if can? :manage, Song %>
    <th style="width: 10%;">Actions</th>
  <% end %>
  </tr>
  </thead>
  <tbody data-infinite-scroll-target="tbody">
  <%= render '/songs/song_rows', songs: songs, show_lyrics_snippet: show_lyrics_snippet %>
  </tbody>
</table>

<% if use_paging and defined?(@pagy) && @pagy && @pagy.pages > 1 %>
  <%= render 'shared/pagination', pagy: @pagy %>
<% end %>


